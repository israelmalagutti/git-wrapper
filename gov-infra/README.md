# GovTheory (`gov-infra/`)

This directory contains **repo-local governance artifacts** generated by GovTheory (GOV). It is designed to make
quality/security/compliance work explicit, versioned, and resistant to “green by exclusion”.

## Quick Start

From the repository root:

Run the verifier after every change (application code, configs, or `gov-infra/**`) so regressions are caught immediately.

1) Run the deterministic rubric verifier:
   - `bash gov-infra/verifiers/gov-verify-rubric.sh`
2) Read the machine report:
   - `gov-infra/evidence/gov-rubric-report.json`
3) Inspect evidence logs for each rubric ID:
   - `gov-infra/evidence/*-output.log`

Notes:
- Verifier scripts are intentionally safe to commit **without** execute permissions; always run via `bash …`.
- Missing or unimplemented checks should be recorded as `BLOCKED`, not “fixed” by weakening gates.
- `SEC-3` (supply-chain) may materialize Node dependencies with scripts disabled and scan `node_modules` lifecycle hooks, plus lightweight scans of `go.mod` and Python dependency files. Use the allowlist only with justification: `gov-infra/planning/git-wrapper-supply-chain-allowlist.txt`.

## What’s In Here

- `gov-infra/pack.json`: provenance + the source of truth for the signed artifact set (additive-only).
- `gov-infra/planning/`: threat model, controls matrix, rubric, roadmap, evidence plan, drift recovery.
- `gov-infra/verifiers/`: deterministic verifier entrypoints (run via `bash`, not `./`).
- `gov-infra/evidence/`: reports + logs written by verifiers (deterministic paths).
- `gov-infra/prompts/`: optional JSON prompt/spec blobs for user agents (generated server-side).

## Working Rules (Humans + Agents)

- Keep all governance outputs under `gov-infra/`.
- Treat the rubric/roadmap as living documents: they are not static; keep them versioned in git and evolve them intentionally.
- Don’t relax gates by excluding directories, lowering thresholds, or disabling checks.
- If a verifier depends on a missing tool/version pin, **fail closed** (`BLOCKED`) until pinned.
- Don’t commit secrets into `gov-infra/`.
- If verifiers create `gov-infra/.tools/` (pinned tool installs), treat it as local-only (don’t commit binaries).
- If you suppress a `SEC-3` finding, add the exact ID to `gov-infra/planning/git-wrapper-supply-chain-allowlist.txt` with a justification comment.

## Repository-Level AGENTS.md (Recommended)

GovTheory provides agent instructions scoped to `gov-infra/**` in `gov-infra/AGENTS.md`. To ensure agents working
anywhere in the repo consistently run governance verification, create or update a repo-root `AGENTS.md` to include a
GovTheory section like:

```md
## GovTheory (gov-infra)
- Read `gov-infra/README.md` for how GovTheory verification works.
- After any change to application code, configs, or `gov-infra/**`, run: `bash gov-infra/verifiers/gov-verify-rubric.sh`
- Treat FAIL/BLOCKED as blockers; do not weaken gates to make checks pass.
```

## CI Integration (Required)

Wire your CI to run:
- `bash gov-infra/verifiers/gov-verify-rubric.sh`

and treat failures as merge blockers. This is required for maintainability (MAI-4).

## Next Steps

- Open `gov-infra/planning/` and follow the next step in the roadmap.
- Use `theory gov validate` for authenticated deterministic validation.
- Use `theory gov sign` locally when you’re ready to certify + sign the governance bundle.
